<script>
  var posterIntervalID = null;
  var getPosterPath = "<%= get_poster_episode_path(@episode)%>";
  $(document).ready(function(){
    updateProcessingElements(posterIntervalID, "#poster.processing", getPosterPath);
  });
</script>
<div class="left_articles">
  <h2>
    <%= link_to "#{@episode.series.full_name}", show_path(@episode.series) %>
    <%= link_to "S#{@episode.season.number.to_s.rjust(2, "0")}", show_season_path(:season_number => @episode.season.number, :show_id => @episode.series.id) %><%= "E#{@episode.number.to_s.rjust(2, "0")}" %> - <%= @episode.name %>
  </h2>
	<p class="description"><%= aired_on(@episode.first_aired) %></p>
	<div id="episode-<%= @episode.id %>" class="episode_info">
  	<div>
      <%= render "poster" %>
      <% if @episode.available? %>
        <div>
          <% description = truncate(@episode.description, 795, "") %>
          <%= description %>
          <% if !@episode.description.blank? && @episode.description.length > description.length %>
            <%= link_to_function("...", "showMoreDescription(this);") %>
            <span style="display:none">
              <%= @episode.description[(description.length)..-1] %>
            </span>
          <% end %>
        </div>
      <% else %>
        
      <% end %>
  	</div>
  	<div class="clear"></div>
  </div>
</div>

<%= render :partial => "shared/comments", :locals => { :comment_path => comment_episode_path(@episode), :comments => @episode.comments }%>